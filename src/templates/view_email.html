{% extends "base.html" %}
{% block title %}{{ email.subject }}{% endblock %}
{% block content %}

<div class="email-view">
  <div class="view-header">
    <a href="#" onclick="if(document.referrer){history.back();}else{window.location='/';}" class="back btn">[back]</a>
    <h2 class="view-subject">{{ email.subject }}</h2>
  </div>

  <div class="view-meta">
    <div class="meta-item"><strong>From</strong> {{ email.from }}</div>
    <!-- <div class="meta-item"><strong>To</strong> {{ email.to }}</div> -->
    <div class="meta-item"><strong>Date</strong> {{ email.date }}</div>
  </div>

  <div class="view-body">
    <iframe style="width: 100%; height:90vh; border: 0;" srcdoc="{{ email.body }}"></iframe>
  </div>

  <div class="view-actions">
    <a href="{{ url_for('compose') }}?reply_to={{ email.from }}&subject=Re:%20{{ email.subject }}" class="btn">Reply</a>
    <a href="{{ url_for('compose') }}?forward={{ email.id }}&subject=Fwd:%20{{ email.subject }}" class="btn">Forward</a>
    <div>
      <a href="#"
        class="btn"
        style="background:#ee0000"
        onclick="fetch('{{ url_for('action_delete') }}', {
            method:'POST',
            headers:{'Content-Type':'application/json'},
            body: JSON.stringify({ uid: '{{ email.id }}', folder: '{{ folder }}' })
        }).then(r => r.ok && (window.location.href='{{ url_for('trash') }}')); return false;">
        Delete
      </a>
    </div>
  </div>
</div>

{% endblock %}
